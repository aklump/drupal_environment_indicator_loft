var lunrIndex = [{"id":"changelog","title":"Changelog","body":"All notable changes to this project will be documented in this file.\n\nThe format is based on [Keep a Changelog](https:\/\/keepachangelog.com\/en\/1.0.0\/), and this project adheres to [Semantic Versioning](https:\/\/semver.org\/spec\/v2.0.0.html).\n\n## [1.3] - 2022-02-02\n\n### Added\n\n- Git icon next to the branch name.\n\n### Changed\n\n- To override the output message use `$config['environment_indicator.indicator']['override']`\n- `$config['environment_indicator.indicator']['autocookie']` is now called `$config['environment_indicator.indicator']['throttle']`.\n\n### Removed\n\n- Deprecated.\n\n### Fixed\n\n- The override message was not working.\n\n## [1.1] - 2021-09-01\n\n### Added\n\n- Setting in the admin form to hide for various durations \/admin\/config\/development\/environment-indicator."},{"id":"configuring","title":"Configuring","body":"## Via Web UI\n\n1. Open _\/admin\/config\/development\/environment-indicator_\n1. Uncheck all _Toolbar integration_ boxes and _Save configuration_.\n1. Do not create an Environment Switcher.\n\n## Who Sees It?\n\nWhich users will see the indicator is determined by permissions.\n\n1. Go to _People > Permissions > Environment Indicator_\n2. Setup the correct permissions.\n\nSee also [Live Dev Porter](@live_dev_porter).\n\n## Set the Label\n\nSee also [Snippets](@snippets) for other ideas.\n\n_settings.php_\n\n```php\n$config['environment_indicator.indicator']['name'] = 'Development';\n```\n\n## Set the Colors\n\n_settings.php_\n\n```php\n$config['environment_indicator.indicator']['bg_color'] = '#00339a';\n$config['environment_indicator.indicator']['fg_color'] = '#fff';\n```\n\n## Set Double-Click-to-Hide Duration\n\n_settings.php_\n\n```php\n$config['environment_indicator.indicator']['manual_cookie'] = 1800;\n```\n\n## Handling Site Configuration Files\n\n@see [Config Fixer](@config_fixer)"},{"id":"config_fixer","title":"Configuring with Config Fixer","body":"This page refers to usage with [Drupal Config Fixer](https:\/\/github.com\/aklump\/drupal-config-fixer)\n\n_.web\\_package\/hooks\/build\/00\\_config\\_fixer.php_\n\n```php\nuse AKlump\\Drupal\\ConfigFixer\\ConfigFixer;\n\n$fix = new ConfigFixer('.\/private\/default\/config\/base');\n\n$fix->modules()\n  ->disable('environment_indicator')\n  ->disable('environment_indicator_loft');\n\n$fix\n  ->roles(['anonymous', 'authenticated'])\n  ->removeDependency('environment_indicator')\n  ->removePermission('access environment indicator');\n\n$fix->files()\n  ->delete('environment_indicator.settings.yml');\n```\n\nAfter configuration export and before deployment run this above to remove the dev configuration."},{"id":"live_dev_porter","title":"Configuring with Live Dev Porter","body":"This page refers to usage with [Live Dev Porter](https:\/\/github.com\/aklump\/live_dev_porter)\n\n## Processor\n\n```php\n# Handle the configuration of development modules.\n!  drush en environment_indicator_loft -y && echo \"Failed to enable development modules.\" && exit 1\ndrush role-add-perm anonymous 'access environment indicator'\ndrush role-add-perm authenticated 'access environment indicator'\ndrush cdel -y environment_indicator.settings toolbar_integration\ndrush cset -y --input-format=yaml environment_indicator.settings toolbar_integration \"toolbar: '0'\"\ndrush cset -y environment_indicator.settings favicon 0\n```"},{"id":"readme","title":"Environment Indicator Loft UX, a Drupal Module","body":"![Environment Indicator Loft](..\/..\/images\/screenshot.png)\n\n## Summary\n\nThis is an alternative UX by [In the Loft Studios](http:\/\/intheloftstudios.com) for the well known Drupal module [Environment Indicator](https:\/\/www.drupal.org\/project\/environment_indicator).\n\n## Features\n\n* Removes the color from the admin toolbar, and wraps the entire screen in a faint edge glow.\n* Adds an informative label in the corner of the window.\n* Provides the GIT branch in the description.\n* Allows hiding the indicator by clicking or double clicking the label.\n* Is highly customizable at the code-level.\n\nSee [installing](@installing) and [configuring](@configuring) to get started.\n\n## Requirements\n\n1. [Environment Indicator Drupal module](https:\/\/www.drupal.org\/project\/environment_indicator)\n\n## Usage\n\nThe border can get in the way when doing front-end developing therefor it can be hidden easily. Single clicking it will hide it until the next request, and double clicking will hide it for all new requests for a length of time.\n\n## Contributing\n\nIf you find this project useful... please consider [making a donation](https:\/\/www.paypal.com\/cgi-bin\/webscr?cmd=_s-xclick&hosted_button_id=4E5KZHDQCEUV8&item_name=Gratitude%20for%20aklump%2Fenvironment_indicator_loft)."},{"id":"installing","title":"Installing","body":"1. Add the following to your project's root _composer.json_.\n   ```json\n   {\n     \"repositories\": [\n       {\n         \"type\": \"github\",\n         \"url\": \"https:\/\/github.com\/aklump\/drupal_environment_indicator_loft\"\n       }\n     ]\n   }\n   ```\n2. `composer require aklump_drupal\/environment_indicator_loft`\n3. `drush en environment_indicator_loft`\n\nNext step [configuring](@configuring)."},{"id":"my_strategy","title":"My Strategy","body":"This is just one way to do it.\n\n1. Only enable this module in non-production environments. @see [this method](@live_dev_porter)\n3. Do not commit configuration export files for this module to the repository. @see [this method](@config_fixer)"},{"id":"snippets","title":"Snippets","body":"## Multiple Environment Setup\n\n_settings.php_\n\n```php\nswitch (DRUPAL_ENV) {\n  case DRUPAL_ENV_DEV:\n    $config['environment_indicator.indicator']['bg_color'] = '#0ff';\n    $config['environment_indicator.indicator']['fg_color'] = '#000';\n    $config['environment_indicator.indicator']['name'] = 'Development';\n    break;\n\n  case DRUPAL_ENV_STAGING:\n    $config['environment_indicator.indicator']['bg_color'] = '#0f0';\n    $config['environment_indicator.indicator']['fg_color'] = '#000';\n    $config['environment_indicator.indicator']['name'] = 'Test';\n    break;\n}\n```\n\n### For a Demonstration Website\n\nYou can use something like the following for demo websites:\n\n_settings.php_\n\n```php\n$config['environment_indicator.indicator']['bg_color'] = '#ff7f00';\n$config['environment_indicator.indicator']['fg_color'] = '#000';\n\n\/\/ Let demo users know their data is not persistent by overriding the message.\n$config['environment_indicator.indicator']['override'] = 'Demonstration Website: Your Data May Be Deleted At Any Time';\n\n\/\/ Auto fade-out message after this many seconds, on each page request.\n$config['environment_indicator.indicator']['autofade'] = 6;\n\n\/\/ ... don't want to show on every request, use a cookie to hide for this many\n\/\/ seconds after showing.  In this example the override message will appear once\n\/\/ every 10 minutes.\n$config['environment_indicator.indicator']['throttle'] = 600;\n```\n\n### Showing Dates of Last Git Pull and DB Sync\n\nHere is an idea for showing dates in the label instead of the git branch.  The file _cached_db.txt_ contains an ISO8601 timestamp of when the database was imported from live, so we can report on that date.\n\n```php\n\/**\n * Implements hook_preprocess_THEME().\n *\n * This hook will add the dates the database was last pulled with ldp, and also\n * the date of the most recent git commit, so assuming the newest the code is.\n *\/\nfunction my_module_preprocess_environment_indicator(&$vars) {\n  $message = ['Live sync:'];\n  if (DRUPAL_ENV !== DRUPAL_ENV_DEV) {\n    $message[] = 'Code @code,';\n  }\n  $message[] = 'Content @content';\n\n  $code = '?';\n  if (($date_of_last_commit = exec('git log -1 --pretty=tformat:%cI'))) {\n    $code = date_create($date_of_last_commit)->format('n\/y');\n  }\n\n  $content = '?';\n  $db_date_file = DRUPAL_ROOT . \"\/..\/.loft_deploy\/prod\/cached_db.txt\";\n  if (file_exists($db_date_file)) {\n    $date_of_database = trim(file_get_contents($db_date_file));\n    $content = date_create($date_of_database)->format('n\/y');\n  }\n\n  $vars['branch'] = t(implode(' ', $message), [\n    '@code' => $code,\n    '@content' => $content,\n  ]);\n}\n```"},{"id":"troubleshooting","title":"Troubleshooting","body":"## Not Seeing the Indicator?\n\nAny of the following will prevent the border from showing:\n\n1. _Environment Indicator Loft_ is not enabled.\n2. _Toolbar_ integration is enabled (checked) as seen at \/admin\/config\/development\/environment-indicator\n3. The user viewing the site does not have the permission _See environment indicator..._\n4. `$config['environment_indicator.indicator']['name']` is set to an empty value."}]